# Minimal Stage-B config template for quick local runs.
# For a no-model audit, prefer: `bash scripts/stage_b.sh smoke`

stage_a_paths:
  - output_post/stage_a/挡风板安装检查_stage_a_tiny.jsonl
seed: 17

model:
  model_name_or_path: model_cache/models/Qwen/Qwen3-32B
  torch_dtype: bfloat16
  device_map: auto

guidance:
  path: output_post/stage_b/initial_guidance.json
  retention: 5
  reset_on_rerun: false

output:
  root: output_post/stage_b
  run_name: smoke_tiny
  group_report: true

sampler:
  samples_per_decode: 1
  grid:
    - temperature: 0.2
      top_p: 0.9
      max_new_tokens: 512
      seed: 42
      repetition_penalty: 1.05
      stop: ["assistant", "<|im_end|>", "<|endoftext|>", "</s>"]

reflection:
  decision_prompt_path: configs/prompts/stage_b_reflection_decision_prompt.txt
  ops_prompt_path: configs/prompts/stage_b_reflection_ops_prompt.txt
  batch_size: 2
  max_operations: 3
  temperature: 0.001
  top_p: 0.9
  repetition_penalty: 1.05
  max_new_tokens: 4096
  max_reflection_length: 12000
  token_budget: 12000

selection:
  policy: top_label
  tie_break: temperature

manual_review:
  min_verdict_agreement: 0.8

runner:
  epochs: 1
  rollout_batch_size: 1

stage_b_distillation:
  enabled: false
