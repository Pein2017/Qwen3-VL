extends:
  - summary_1024.yaml

# Experimental preset: emphasize schema/field stability in summary outputs.
# Motivation: Stage-B relies on stable per-category attribute keys (e.g. 电线/捆扎),
# but Stage-A sometimes emits the category while omitting the attribute key.

model:
  model: output/1-18/grpo_summary_1024_attr_key_recall/ckpt_1300

training:
  # Avoid clobbering prior runs; edit per-run as needed.
  output_dir: ./output/1-18/grpo_summary_1024_attr_key_recall
  logging_dir: ./tb/1-18/grpo_summary_1024_attr_key_recall
  run_name: attr_key_recall
  num_train_epochs: 4

rlhf:
  # Adds `summary.attr_key_recall` to explicitly reward emitting the same (类别, 属性名)
  # keys as the ground-truth summary_ref, independent of count calibration.
  # Also adds `summary.attr_path_recall` to reward emitting stable nested attribute paths
  # (e.g. 捆扎/整齐) for categories the model chooses to emit (scoring categories are
  # pred ∩ ref, so omitting a category is not directly penalized by this reward).
  reward_funcs:
    [
      summary.format,
      summary.header,
      summary.strict,
      summary.parse,
      summary.no_dup_keys,
      summary.dataset,
      summary.category_recall,
      summary.attr_key_recall,
      summary.attr_path_recall,
      summary.content_structured_tversky,
      summary.group_stats_presence,
    ]
  # Suggested weights (recall-first):
  # - Keep format/header/strict strong to prevent schema drift.
  # - Add a dedicated key-recall reward to stabilize field emission.
  # - Add a nested attr-path recall reward to improve schema completeness for stable keys.
  # - Slightly upweight structured tversky vs baseline preset.
  reward_weights: [1.0, 2.0, 2.0, 1.5, 2.0, 0.5, 2.0, 2.0, 2.0, 4.0, 0.2]
