extends: ./last_6_base.yaml

rlhf:
  rlhf_type: gkd
  # Use a stable, cached teacher checkpoint; tests assert this lives under
  # ``model_cache/`` and is distinct from the student path.
  teacher_model: model_cache/models/Qwen/Qwen3-VL-8B-Instruct
  sft_alpha: 1.0
  llm_kd_weight: 0.01
  seq_kd: false
  lmbda: 0.0

training:
  run_name: lvis_ratio_0.08-epoch_30-dlora-lrs_4_2_8-llm_kd_0.01-vision_kd_0.01-last_6_vision-all_llm-from_base

custom:
  trainer_variant: gkd_monitor
  visual_kd:
    enabled: true
    vit:
      enabled: true
      weight: 0.01
      distance: cosine
    aligner:
      enabled: true
      weight: 0.01  # Heavier anchor on vision/aligner (0.1-0.2 typical). Lower if visuals overfit.
      distance: cosine
    deepstack:
      enabled: true
      weight: 0.01
      distance: cosine
